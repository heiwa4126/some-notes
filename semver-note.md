# Semantic Versioning (semver)とそれに似たものメモ

## 規格

- semver
  - [Semantic Versioning 2.0.0 | Semantic Versioning](https://semver.org/)
  - [セマンティック バージョニング 2.0.0 | Semantic Versioning](https://semver.org/lang/ja/)
- requirements.txt (Python) PEP 440
  - [PEP 440 – Version Identification and Dependency Specification | peps.python.org](https://peps.python.org/pep-0440/)
  - [PEP 440 (Python のバージョン・スキーマ) 概説](https://zenn.dev/shinsa82/articles/pep-440-overview)
- package.json (Node) Node-semver
  - [package.json | npm Docs](https://docs.npmjs.com/cli/v10/configuring-npm/package-json)
  - [npm/node-semver: The semver parser for node (the one npm uses)](https://github.com/npm/node-semver)

## 概要

| 特徴                     | SemVer                      | package.json                | requirements.txt         |
| ------------------------ | --------------------------- | --------------------------- | ------------------------ |
| バージョン形式           | `MAJOR.MINOR.PATCH`         | `MAJOR.MINOR.PATCH`         | `MAJOR.MINOR.PATCH`      |
| 固定バージョン指定       | `1.2.3`                     | `1.2.3`                     | `1.2.3` または `==1.2.3` |
| 固定バージョン指定 2     | N/A                         | `==1.2.3` (非標準)          | `==1.2.3`                |
| 最低バージョン指定       | `>=1.2.3`                   | `>=1.2.3`                   | `>=1.2.3`                |
| 最高バージョン指定       | `<=1.2.3`                   | `<=1.2.3`                   | `<=1.2.3`                |
| 範囲バージョン指定       | `>=1.2.3 <2.0.0`            | `^1.2.3` (`1.x.x`)          | `1.2.3, <2.0.0`          |
| 最新版指定               | `*`                         | `latest`                    | `*`                      |
| プレリリースバージョン   | `1.2.3-alpha`, `1.2.3-beta` | `1.2.3-alpha`, `1.2.3-beta` | `1.2.3a1`, `1.2.3b1`     |
| 任意のパッチバージョン   | `1.2.x`                     | `1.2.x`                     | `1.2.*`                  |
| 任意のマイナーバージョン | `1.x`                       | `1.x`                       | `1.*`                    |
| キャレット範囲指定       | N/A                         | `^1.2.3`                    | N/A                      |
| チルダ範囲指定           | `~1.2.3` (非標準)           | `~1.2.3`                    | N/A                      |

- **固定バージョン指定 2**: `==1.2.3` の形式で特定のバージョンを指定します。SemVer そのものには存在しませんが、`requirements.txt` では標準的に使われ、`package.json` では非標準的に使用される場合があります。

## `package.json`におけるキャレット範囲指定(^)

| 実例            | 許容範囲                | 説明                                                           |
| --------------- | ----------------------- | -------------------------------------------------------------- |
| `^1.2.3`        | `>=1.2.3 <2.0.0`        | メジャーバージョンが変わらない範囲(1.x.x)                      |
| `^0.2.3`        | `>=0.2.3 <0.3.0`        | メジャーバージョンが 0 の場合、マイナーが変わらない範囲(0.2.x) |
| `^0.0.3`        | `>=0.0.3 <0.0.4`        | メジャー、マイナーが 0 の場合、パッチが変わらない範囲(0.0.x)   |
| `^1.2.3-beta.2` | `>=1.2.3-beta.2 <2.0.0` | プレリリースバージョンも含む                                   |

- `^1.2.3` は `1.2.3` から始まり、メジャーバージョンが変わらない範囲(1.x.x)まで許容します。すなわち、 `>=1.2.3` かつ `<2.0.0` の範囲のバージョンをインストールします。
- `^0.2.3` は `0.2.3` から始まり、マイナーバージョンが変わらない範囲(0.2.x)まで許容します。すなわち、 `>=0.2.3` かつ `<0.3.0` の範囲のバージョンをインストールします。
- `^0.0.3` は `0.0.3` から始まり、パッチバージョンが変わらない範囲(0.0.x)まで許容します。すなわち、 `>=0.0.3` かつ `<0.0.4` の範囲のバージョンをインストールします。
- 上記表の最終行以外のパターンではプレリリースバージョンは含まれません。

## `package.json`におけるチルダ範囲指定(~)

| 実例            | 許容範囲                | 説明                                      |
| --------------- | ----------------------- | ----------------------------------------- |
| `~1.2.3`        | `>=1.2.3 <1.3.0`        | マイナーバージョンが変わらない範囲(1.2.x) |
| `~0.2.3`        | `>=0.2.3 <0.3.0`        | マイナーバージョンが変わらない範囲(0.2.x) |
| `~1.2.3-beta.2` | `>=1.2.3-beta.2 <1.3.0` | プレリリースバージョンも含む              |

- `~1.2.3` は `1.2.3` から始まり、マイナーバージョンが変わらない範囲(1.2.x)まで許容します。すなわち、 `>=1.2.3` かつ `<1.3.0` の範囲のバージョンをインストールします。
- `~0.2.3` は `0.2.3` から始まり、マイナーバージョンが変わらない範囲(0.2.x)まで許容します。すなわち、 `>=0.2.3` かつ `<0.3.0` の範囲のバージョンをインストールします。
- 上記表の最終行以外のパターンではプレリリースバージョンは含まれません。

## キャレット範囲指定とチルダ範囲指定はわかりにくい

例えば
`~1.2` と `1.2.x` は等価なので
`1.2.x` を使うべきだと思う。
