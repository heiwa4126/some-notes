# CodeCommit で驚いたこと

レポジトリにリージョンがある。

## HTTPS (GRC)で驚いたこと

認証は AWS IAM ユーザの「アクセスキー」の方で行う。
「AWS CodeCommit の HTTPS Git 認証情報」の方は使わない。

```sh
pip3 install --user -U git-remote-codecommit
```

でインストール。

.git/config はこんな感じ

```
(略)
[remote "codecommit1"]
    url = codecommit::us-east-1://sam-hello-py
    fetch = +refs/heads/*:refs/remotes/origin/*
(略)
```

んで

```sh
AWS_PROFILE=codecommit1 git push codecommit1
```

みたいに使う。

## AWS CodeCommit レポジトリをパブリックにすることはできますか?

AWS CodeCommit レポジトリをパブリックにすることはできません。
CodeCommit は AWS のプライベート Git リポジトリサービスであり、
デフォルトでリポジトリは組織内の認可されたユーザーのみがアクセスできるよう設定されています。

ただし、
CodeCommit リポジトリに IAM ユーザーや匿名の Git ユーザーを追加して、
個別にリポジトリにアクセスさせることは可能です(厳密にはプライベートですが)。

(以下未検証)

CodeCommit リポジトリに IAM ユーザーや匿名の Git ユーザーを追加して、個別にアクセスさせる方法は以下の通りです。

1. **IAM ユーザーを追加する場合**

- CodeCommit コンソールからリポジトリを選択
- "リポジトリの設定" -> "アクセス権限の管理"
- "IAM ユーザーを追加"を選択
- 既存の IAM ユーザーを選択、もしくは新しいユーザーを作成
- そのユーザーに CodeCommit の権限を付与

2. **匿名の Git ユーザーを追加する場合**

- CodeCommit コンソールからリポジトリを選択
- "リポジトリの設定" -> "アクセス権限の管理"
- "Git 認証資格情報の作成"を選択
- ユーザー名とパスワードを設定
- そのユーザー資格情報を送付したいユーザーに共有

これらの方法で追加したユーザーは、リポジトリのクローン、プッシュ、プルなどの操作が可能になります。

ただし、このようにリポジトリへのアクセス権を広く付与することには、セキュリティ上のリスクが伴います。そのため、以下の点に注意が必要です。

- アクセス権の付与範囲を必要最小限に留める
- パスワードの定期的な変更を行う
- できる限り IAM ユーザーを使い、匿名ユーザーの使用は避ける
- アクセスログを監視し、不審な活動がないかチェックする

パブリックリポジトリが必要な理由によっては、CodeCommit よりも GitHub/GitLab などのパブリック Git リポジトリを使う方が適切な場合もあります。
